# ============================================================================
# PEACEPAY ENVIRONMENT CONFIGURATION
# ============================================================================
# Copy this file to .env and update values for your environment
# NEVER commit .env files to version control
# ============================================================================

# -----------------------------------------------------------------------------
# APPLICATION
# -----------------------------------------------------------------------------
APP_NAME=PeacePay
APP_ENV=local                    # local, staging, production
APP_KEY=                         # Run: php artisan key:generate
APP_DEBUG=true                   # Set to false in production
APP_URL=http://localhost:8000

# Timezone (Egypt)
APP_TIMEZONE=Africa/Cairo
APP_LOCALE=ar
APP_FALLBACK_LOCALE=en

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
LOG_CHANNEL=stack                # stack, single, daily, stderr
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=debug                  # debug, info, notice, warning, error, critical

# -----------------------------------------------------------------------------
# DATABASE
# -----------------------------------------------------------------------------
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=peacepay
DB_USERNAME=root
DB_PASSWORD=
DB_CHARSET=utf8mb4
DB_COLLATION=utf8mb4_unicode_ci

# Read replica (production only)
# DB_READ_HOST=replica.peacepay.rds.amazonaws.com

# -----------------------------------------------------------------------------
# REDIS
# -----------------------------------------------------------------------------
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379
REDIS_CLIENT=phpredis

# Prefixes
REDIS_PREFIX=peacepay_

# -----------------------------------------------------------------------------
# CACHE
# -----------------------------------------------------------------------------
CACHE_DRIVER=redis               # file, redis, memcached
CACHE_PREFIX=peacepay_cache

# -----------------------------------------------------------------------------
# SESSION
# -----------------------------------------------------------------------------
SESSION_DRIVER=redis             # file, cookie, redis, database
SESSION_LIFETIME=120
SESSION_ENCRYPT=true
SESSION_PATH=/
SESSION_DOMAIN=null

# -----------------------------------------------------------------------------
# QUEUE
# -----------------------------------------------------------------------------
QUEUE_CONNECTION=redis           # sync, database, redis, sqs

# Queue names
QUEUE_DEFAULT=default
QUEUE_NOTIFICATIONS=notifications
QUEUE_PAYMENTS=payments

# Worker settings
QUEUE_RETRY_AFTER=90
QUEUE_BLOCK_FOR=5

# -----------------------------------------------------------------------------
# MAIL
# -----------------------------------------------------------------------------
MAIL_MAILER=smtp
MAIL_HOST=mailpit
MAIL_PORT=1025
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS="noreply@peacepay.eg"
MAIL_FROM_NAME="${APP_NAME}"

# Production (SendGrid/SES)
# MAIL_MAILER=ses
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_DEFAULT_REGION=me-south-1

# -----------------------------------------------------------------------------
# SMS (Twilio)
# -----------------------------------------------------------------------------
TWILIO_SID=
TWILIO_TOKEN=
TWILIO_FROM=+20xxxxxxxxx
TWILIO_VERIFY_SID=              # For OTP verification service

# Backup SMS provider (Infobip)
INFOBIP_API_KEY=
INFOBIP_BASE_URL=
INFOBIP_SENDER=PeacePay

# SMS Settings
SMS_OTP_LENGTH=6
SMS_OTP_EXPIRY_MINUTES=5
SMS_RATE_LIMIT_PER_PHONE=5      # Max OTPs per phone per hour

# -----------------------------------------------------------------------------
# PAYMENT GATEWAYS
# -----------------------------------------------------------------------------
# Hyperswitch (Primary)
HYPERSWITCH_API_KEY=
HYPERSWITCH_API_URL=https://sandbox.hyperswitch.io
HYPERSWITCH_MERCHANT_ID=
HYPERSWITCH_PUBLISHABLE_KEY=

# Fawry
FAWRY_MERCHANT_CODE=
FAWRY_SECURITY_KEY=
FAWRY_BASE_URL=https://atfawry.fawrystaging.com

# Paymob
PAYMOB_API_KEY=
PAYMOB_INTEGRATION_ID=
PAYMOB_IFRAME_ID=
PAYMOB_HMAC_SECRET=

# Vodafone Cash
VODAFONE_MERCHANT_ID=
VODAFONE_API_KEY=
VODAFONE_BASE_URL=

# -----------------------------------------------------------------------------
# AUTHENTICATION
# -----------------------------------------------------------------------------
# JWT
JWT_SECRET=                      # Run: php artisan jwt:secret
JWT_TTL=60                       # Token lifetime in minutes
JWT_REFRESH_TTL=20160           # Refresh token lifetime (14 days)
JWT_ALGO=HS256

# PIN Security
PIN_MIN_LENGTH=6
PIN_MAX_ATTEMPTS=5
PIN_LOCKOUT_MINUTES=30

# API Keys (for external integrations)
API_KEY_HEADER=X-API-Key
API_SIGNATURE_HEADER=X-Signature
API_TIMESTAMP_HEADER=X-Timestamp
API_SIGNATURE_TOLERANCE=300     # 5 minutes

# -----------------------------------------------------------------------------
# RATE LIMITING
# -----------------------------------------------------------------------------
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_LOGIN_ATTEMPTS=5
RATE_LIMIT_OTP_REQUESTS=3

# -----------------------------------------------------------------------------
# PEACELINK SETTINGS
# -----------------------------------------------------------------------------
# Expiry
PEACELINK_DEFAULT_EXPIRY_HOURS=24
PEACELINK_MAX_DELIVERY_DAYS=7
PEACELINK_OTP_EXPIRY_HOURS=24

# Limits
PEACELINK_MIN_AMOUNT=10
PEACELINK_MAX_AMOUNT=100000
PEACELINK_MAX_DSP_REASSIGNMENTS=1

# Advance payment
PEACELINK_ADVANCE_MIN_PERCENT=0
PEACELINK_ADVANCE_MAX_PERCENT=50
PEACELINK_ADVANCE_ALLOWED_VALUES=0,25,50

# -----------------------------------------------------------------------------
# FEES (Override database config)
# -----------------------------------------------------------------------------
# These can be set here or in database (database takes precedence)
# FEE_MERCHANT_PERCENTAGE=0.005     # 0.5%
# FEE_MERCHANT_FIXED=2.00           # 2 EGP
# FEE_DSP_PERCENTAGE=0.005          # 0.5%
# FEE_ADVANCE_PERCENTAGE=0.005      # 0.5%
# FEE_CASHOUT_PERCENTAGE=0.015      # 1.5%

# -----------------------------------------------------------------------------
# KYC LIMITS (EGP)
# -----------------------------------------------------------------------------
KYC_LEVEL_1_DAILY_LIMIT=5000
KYC_LEVEL_1_MONTHLY_LIMIT=20000
KYC_LEVEL_1_SINGLE_LIMIT=2000

KYC_LEVEL_2_DAILY_LIMIT=50000
KYC_LEVEL_2_MONTHLY_LIMIT=200000
KYC_LEVEL_2_SINGLE_LIMIT=20000

KYC_LEVEL_3_DAILY_LIMIT=500000
KYC_LEVEL_3_MONTHLY_LIMIT=2000000
KYC_LEVEL_3_SINGLE_LIMIT=100000

# -----------------------------------------------------------------------------
# FILE STORAGE
# -----------------------------------------------------------------------------
FILESYSTEM_DISK=local            # local, s3

# S3 (Production)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=me-south-1
AWS_BUCKET=peacepay-uploads
AWS_USE_PATH_STYLE_ENDPOINT=false

# -----------------------------------------------------------------------------
# MONITORING & LOGGING
# -----------------------------------------------------------------------------
# Sentry
SENTRY_LARAVEL_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1

# Telescope (dev only)
TELESCOPE_ENABLED=true

# Horizon (queue monitoring)
HORIZON_PREFIX=peacepay_horizon_

# -----------------------------------------------------------------------------
# BROADCASTING
# -----------------------------------------------------------------------------
BROADCAST_DRIVER=pusher          # null, pusher, redis

# Pusher
PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=mt1
PUSHER_HOST=
PUSHER_PORT=443
PUSHER_SCHEME=https

# -----------------------------------------------------------------------------
# WEBHOOKS
# -----------------------------------------------------------------------------
WEBHOOK_SECRET=                  # For HMAC signature validation
WEBHOOK_TIMEOUT=30
WEBHOOK_RETRY_ATTEMPTS=3

# -----------------------------------------------------------------------------
# CORS
# -----------------------------------------------------------------------------
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,X-API-Key,X-Signature,X-Timestamp
CORS_MAX_AGE=86400

# -----------------------------------------------------------------------------
# SECURITY
# -----------------------------------------------------------------------------
# HTTPS
FORCE_HTTPS=false                # Set to true in production

# CSP Headers
CSP_ENABLED=false

# Trusted proxies (for load balancer)
TRUSTED_PROXIES=*

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------
FEATURE_REGISTRATION_ENABLED=true
FEATURE_CASHOUT_ENABLED=true
FEATURE_DISPUTES_ENABLED=true
FEATURE_DSP_REASSIGNMENT_ENABLED=true
FEATURE_ADVANCE_PAYMENT_ENABLED=true

# -----------------------------------------------------------------------------
# DEVELOPMENT ONLY
# -----------------------------------------------------------------------------
# Sanctum (API tokens)
SANCTUM_STATEFUL_DOMAINS=localhost,localhost:3000,127.0.0.1,127.0.0.1:8000

# Debug bar
DEBUGBAR_ENABLED=false
